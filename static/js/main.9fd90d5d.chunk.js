(this["webpackJsonpvre-schedule"]=this["webpackJsonpvre-schedule"]||[]).push([[0],{38:function(e,t,n){e.exports=n(63)},43:function(e,t,n){},45:function(e,t,n){},63:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(33),i=n.n(o),s=(n(43),n(44),n(45),n(14)),l=n(15),c=n(18),d=n(16),u=n(19),m=n(67),p=n(68),h=n(66),f=n(64),S=n(34),g=function(e){function t(e){var n;return Object(s.a)(this,t),(n=Object(c.a)(this,Object(d.a)(t).call(this,e))).toggleDirectionsDropdown=function(){n.setState({directionsDropdownOpen:!n.state.directionsDropdownOpen})},n.selectDirectionName=function(e){n.setState({selectedDirectionName:e.currentTarget.textContent,selectedFromStation:null,selectedFromTrain:null,selectedToStation:null,arriveAt:null},(function(){n.populateFromStations()}))},n.populateFromStations=function(){var e=n.state.directions.filter((function(e){return e.label===n.state.selectedDirectionName})).map((function(e){return e.schedule[0].slice(1)}))[0];n.setState({fromStations:e,selectedFromStation:null})},n.toggleFromStationsDropdown=function(){n.setState({fromStationsDropdownOpen:!n.state.fromStationsDropdownOpen})},n.selectFromStation=function(e){n.setState({selectedFromStation:parseInt(e.currentTarget.id),selectedFromTrain:null,selectedToStation:null,arriveAt:null},(function(){n.populateFromTrains(),n.populateToStations()}))},n.populateFromTrains=function(){for(var e=n.state.directions.filter((function(e){return e.label===n.state.selectedDirectionName})).map((function(e){return e.schedule}))[0],t=[],a=1;a<e.length;a++)t.push("["+e[a][0].padStart(11," ")+"] "+e[a][n.state.selectedFromStation+1]);n.setState({fromTrains:t})},n.toggleFromTrainsDropdown=function(){n.setState({fromTrainsDropdownOpen:!n.state.fromTrainsDropdownOpen})},n.selectFromTrain=function(e){n.setState({selectedFromTrain:parseInt(e.currentTarget.id),arriveAt:null},(function(){n.state.selectedToStation&&n.calculateArrivalTime()}))},n.populateToStations=function(){var e=n.state.directions.filter((function(e){return e.label===n.state.selectedDirectionName})).map((function(e){return e.schedule[0].slice(1)}))[0].slice(n.state.selectedFromStation+1);n.setState({toStations:e})},n.toggleToStationsDropdown=function(){n.setState({toStationsDropdownOpen:!n.state.toStationsDropdownOpen})},n.selectToStation=function(e){n.setState({selectedToStation:parseInt(e.currentTarget.id)},(function(){n.calculateArrivalTime()}))},n.calculateArrivalTime=function(){var e=n.state.directions.filter((function(e){return e.label===n.state.selectedDirectionName})).map((function(e){return e.schedule}))[0][n.state.selectedFromTrain+1][n.state.selectedFromStation+1+n.state.selectedToStation+1];n.setState({arriveAt:e})},n.state={error:null,isLoaded:!1,directions:[],directionsDropdownOpen:!1,selectedDirectionName:null,fromStations:[],fromStationsDropdownOpen:!1,selectedFromStation:null,fromTrains:[],fromTrainsDropdownOpen:!1,selectedFromTrain:null,toStations:[],toStationsDropdownOpen:!1,selectedToStation:null,arriveAt:null},n}return Object(u.a)(t,e),Object(l.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.findDirections().then((function(){e.setState({isLoaded:!0})}))}},{key:"findDirections",value:function(){var e=this;return new Promise((function(t,n){e.findFredericksburgNorthboundSchedule(),e.findFredericksburgSouthboundSchedule(),e.findManassasNorthboundSchedule(),e.findManassasSouthboundSchedule(),t()}))}},{key:"findFredericksburgNorthboundSchedule",value:function(){this.findSchedule("Fredericksburg Line - Northbound","https://www.vre.org/service/schedule/schedule-data/fredericksburg-line-northbound/",14,0)}},{key:"findFredericksburgSouthboundSchedule",value:function(){this.findSchedule("Fredericksburg Line - Southbound","https://www.vre.org/service/schedule/schedule-data/fredericksburg-line-southbound/",14,1)}},{key:"findManassasNorthboundSchedule",value:function(){this.findSchedule("Manassas Line - Northbound","https://www.vre.org/service/schedule/schedule-data/manassas-line-northbound/",11,2)}},{key:"findManassasSouthboundSchedule",value:function(){this.findSchedule("Manassas Line - Southbound","https://www.vre.org/service/schedule/schedule-data/manassas-line-southbound/",11,3)}},{key:"findSchedule",value:function(e,t,n,a){var r=this;fetch("https://cors-anywhere.herokuapp.com/"+t).then((function(e){return e.text()})).then((function(t){for(var o=r.cleanseText(t).match(/[^\r\n]+/g),i=[],s=-1,l=0;l<o.length;l++){l%n===0&&(i.push([]),s++);var c=r.findValue(o[l]).trim();i[s].push(c)}var d={label:e,schedule:i},u=r.state.directions;u[a]=d,r.setState({directions:u})}),(function(e){console.log("error"+e),r.setState({isLoaded:!0,error:e})}))}},{key:"findValue",value:function(e){for(var t=/(?:>)(.*)(?:<)/,n=e.match(t);n&&n[1].match(t);)n=n[1].match(t);return n[1]}},{key:"cleanseText",value:function(e){return e.substring(e.indexOf("<table>"),e.indexOf("</table>")).replace(/<table>(?:\r\n|\r|\n)/g,"").replace(/<thead>(?:\r\n|\r|\n)/g,"").replace(/<\/thead>(?:\r\n|\r|\n)/g,"").replace(/<tr>(?:\r\n|\r|\n)/g,"").replace(/<\/tr>(?:\r\n|\r|\n)/g,"").replace(/<tbody>(?:\r\n|\r|\n)/g,"").replace(/<\/tbody>(?:\r\n|\r|\n)/g,"").replace(/<\/time> a.m./g," a.m.</time>").replace(/<\/time>&nbsp;a.m./g," a.m.</time>").replace(/<\/time> p.m./g," p.m.</time>").replace(/<\/time>&nbsp;p.m./g," p.m.</time>").replace(/a.m./g,"AM").replace(/p.m./g,"PM").replace(/<span class="sched-badge sched-badge-secondary">L<\/span>/g,"").replace(/<span class="sched-badge">B<\/span>/g,"").replace(/<span class="sched-badge">S<\/span>/g,"S").replace(/&nbsp;/g,"").replace(/<a href="\/service\/amtrak\/">/g,"").replace(/<\/a><\/td>/g,"</td>")}},{key:"render",value:function(){var e=this,t=this.state,n=t.error,a=t.isLoaded,o=t.directions,i=t.directionsDropdownOpen,s=t.fromStations,l=t.fromStationsDropdownOpen,c=t.fromTrains,d=t.fromTrainsDropdownOpen,u=t.toStations,g=t.toStationsDropdownOpen,v=t.arriveAt;return n?r.a.createElement("div",null,"Error: ",n.message):a?r.a.createElement("div",{style:{width:"300px",maxWidth:"300px"}},r.a.createElement("div",null,r.a.createElement("h3",null,"VRE Schedule")),r.a.createElement("div",{className:"direction"},"Direction",r.a.createElement(m.a,{isOpen:i,toggle:this.toggleDirectionsDropdown,style:{width:"100%"}},r.a.createElement(p.a,{caret:!0,color:"primary"},this.state.selectedDirectionName),r.a.createElement(h.a,null,o.map((function(t){return r.a.createElement(f.a,{id:t.label,key:t.label,onClick:e.selectDirectionName},t.label)}))))),r.a.createElement("div",{className:"from-station"},"From Station",r.a.createElement(m.a,{isOpen:l,toggle:this.toggleFromStationsDropdown,style:{width:"100%"}},r.a.createElement(p.a,{caret:!0},s[this.state.selectedFromStation]),r.a.createElement(h.a,null,s.map((function(t,n){return r.a.createElement(f.a,{id:n,key:n,onClick:e.selectFromStation},t)}))))),r.a.createElement("div",{className:"from-train"},"Depart At",r.a.createElement(m.a,{isOpen:d,toggle:this.toggleFromTrainsDropdown,style:{width:"100%"}},r.a.createElement(p.a,{caret:!0},c[this.state.selectedFromTrain]),r.a.createElement(h.a,null,c.map((function(t,n){return r.a.createElement(f.a,{id:n,key:n,onClick:e.selectFromTrain},r.a.createElement("pre",null,t))})))),r.a.createElement("span",{style:{fontSize:"0.5em"}},"S = Special schedules for holidays and snow days")),r.a.createElement("div",{className:"to-station"},"To Station",r.a.createElement(m.a,{isOpen:g,toggle:this.toggleToStationsDropdown,style:{width:"100%"}},r.a.createElement(p.a,{caret:!0,color:"success"},u[this.state.selectedToStation]),r.a.createElement(h.a,null,u.map((function(t,n){return r.a.createElement(f.a,{id:n,key:n,onClick:e.selectToStation},t)}))))),r.a.createElement("div",{className:"arrive-at"},r.a.createElement("div",null,"Arrive At"),r.a.createElement(S.a,{color:"success",style:{width:"100%"}},v))):r.a.createElement("div",null,"Loading...")}}]),t}(r.a.Component),v=n(65),w=function(e){function t(){return Object(s.a)(this,t),Object(c.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{className:"footer"},r.a.createElement(v.a,null,r.a.createElement("div",null,"I'm a software engineer and ex-VRE rider. I built this just to provide a better user experience for VRE riders."),r.a.createElement("div",null,"This data may go out of date when VRE website changes the layout, so please use this at your own risk. Official VRE website: ",r.a.createElement("a",{href:"https://www.vre.org",target:"_blank",rel:"noopener noreferrer"},"vre.org"))))}}]),t}(r.a.Component),b=n(26);b.a.initialize("UA-115168467-3"),b.a.pageview(window.location.pathname+window.location.search);var E=function(){return r.a.createElement("div",{className:"App"},r.a.createElement("header",{className:"App-header"},r.a.createElement(g,null)),r.a.createElement(w,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(E,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[38,1,2]]]);
//# sourceMappingURL=main.9fd90d5d.chunk.js.map